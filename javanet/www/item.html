<html>
   <head>
      <title>The CaJo Project</title>
      <meta name="Keywords" content="cajo, rmi, java, distributed computing">
      <meta name="Description" content="Cajo Distributed Application Framework">
      <meta name="Author" content="John Catherino">
   </head>
   <body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800000" alink="#FF0000">
      <table width="100%" cellspacing="0" cellpadding="0" border="0">
         <tr>
            <td><img src="images/topl.gif" width="17" height="17" border="0"></td>
            <td width="100%" bgcolor="#8C6239"><img src="images/dot.gif" width="1" height="1" border="0"></td>
            <td><img src="images/topr.gif" width="17" height="17" border="0"></td>
         </tr>
      </table>
      <table width="100%" cellspacing="0" cellpadding="0" border="0">
         <tr>
            <td width="100%" height="15" bgcolor="#8C6239">
               <img src="images/dot.gif" width="1" height="1" border="0">
            </td>
         </tr>
      </table>
      <table width="100%" cellspacing="0" cellpadding="0" border="0">
         <tr>
            <td width="120" valign="top">
               <table width="120" border="0" cellspacing="2" cellpadding="2" align="left">
<!-- begin table.html -->
                  <tr>
                     <td bgcolor="#C0C08D">
                        <font face="Verdana,Geneva,Arial,Helvetica,sans-serif" size="-2">
                           <a href="index.html" title="cajo home page"><b>Welcome</b></a><br>
                        </font>
                     </td>
                  </tr>
                  <tr>
                     <td bgcolor="#C0C08D">
                        <font face="Verdana,Geneva,Arial,Helvetica,sans-serif" size="-2">
                           <a href="tutorial.html" title="getting started"><b>Tutorial</b></a>
                        </font>
                     </td>
                  </tr>
                  <tr>
                     <td bgcolor="#C0C08D">
                        <font face="Verdana,Geneva,Arial,Helvetica,sans-serif" size="-2">
                           <a href="theory.html" title="how it all works"><b>Theory</b></a>
                        </font>
                     </td>
                  </tr>
                  <tr>
                     <td bgcolor="#C0C08D">
                        <font face="Verdana,Geneva,Arial,Helvetica,sans-serif" size="-2">
                           <a href="gotcha.html" title="important details"><b>Gotchas</b></a>
                        </font>
                     </td>
                  </tr>
                  <tr>
                     <td bgcolor="#C0C08D">
                        <font face="Verdana,Geneva,Arial,Helvetica,sans-serif" size="-2">
                           <a href="faq.html" title="common questions"><b>FAQ</b></a>
                        </font>
                     </td>
                  </tr>
                  <tr>
                     <td bgcolor="#C0C08D">
                        <font face="Verdana,Geneva,Arial,Helvetica,sans-serif" size="-2">
                           <a href="acknowlege.html" title="supporters of the marque"><b>Acknowlegements</b></a>
                        </font>
                     </td>
                  </tr>
                  <tr>
                     <td bgcolor="#C0C08D">
                        <font face="Verdana,Geneva,Arial,Helvetica,sans-serif" size="-2">
                           <a href="license.html" title="what's the LGPL"><b>License</b></a>
                        </font>
                     </td>
                  </tr>
                  <tr>
                     <td bgcolor="#C0C08D">
                        <font face="Verdana,Geneva,Arial,Helvetica,sans-serif" size="-2">
                           <a href="docs/overview-summary.html" title="package documentation"><b>Javadocs</b></a>
                        </font>
                     </td>
                  </tr>
<!-- end table.html -->
               </table>
            </td>
            <td width="100%" valign="top">
               <table width="100%" cellpadding="5" border="0">
                  <tr>
                     <td>
                        <font face="Verdana, Helvetica" size="-1">
<!-- begin main.html -->
                           <font face="Verdana, Helvetica" size="4">
                              <b>Server items are the core of the cajo framework.</b>
                           </font><br><br>

                           A server is a Java Virtual Machine that makes one or more of its objects
                           remotely accessible.  A remotely accessible object is called an <b>item</b>
                           in terms of this framework. Items generally derive from the class
                           <a href= docs/gnu/cajo/utils/BaseItem.html>BaseItem</a>,
                           and always implement the <a href=docs/gnu/cajo/invoke/Invoke.html>Invoke</a>
                           interface.  The sole Invoke interface method, also named invoke, is
                           implemented in the base class, and is declared as <u>final</u>.  This is done
                           to emphasize the fact that an item is otherwise an ordinary object, as will
                           be explained.<br><br>

                           The Invoke interface method is an item's primary interfacing method, it
                           also serves to make it remotely callable. Remote objects call the invoke
                           method, passing it a method name, and an argument that can be null.  The
                           invoke implementation of the BaseItem class uses a Java technique called
                           <i>reflection</i> whereby it finds a public method of its subclass, exactly
                           matching the name provided in the remote call, accepting arguments of exactly
                           the type, and in the exact order, provided by the caller.  If there is a
                           match, it will invoke that method on the item, and return the method result,
                           if any.  This technique effectively makes <u>all public methods</u> of
                           subclasses of BaseItem remotely callable.  If no matching method can be found
                           however, in method name and argument type/order, the invocation will result
                           in a <code>NoSuchMethodException</code> being thrown.<br><br>

                           Subclasses of BaseItem are free to implement any public (meaning remotely
                           callable) methods of any type. The only requirement is that another item on
                           a different (or local) machine (virtual or physical) must know the target
                           item's method signature. This is no different than for conventional objects,
                           with one exception, there is no compile time type checking. Also, due to a
                           restriction in the Java reflection mechanism; primitive types such as
                           <code>int</code> or <code>char</code> for example, cannot be sent as
                           arguments, or returned, rather they must be sent in their Object
                           representations, in this case <code>Integer</code> or <code>Character</code>.
                           Basically, all argument and return typechecking will be done at runtime.<br><br>

                           If a legacy object already has a class inheritance, and cannot extend
                           BaseItem, all is not lost.  A BaseItem wrapper can be made, which simply
                           passes the invocations onto its internal legacy object returning the result,
                           if any. It can even perform the conversions between primitive types and their
                           object representations.<br><br>

                           All invocations on an item should be made via its Invoke interface.  While
                           this technique isn't technically necessary when the item is local (i.e. in
                           the same Virtual Machine) it allows the called object to be moved to a
                           remote machine (virtual or physical) with <b>no</b> source code
                           changes. A useful design pattern is to simply place a wrapper around the item
                           reference, where the wrapper methods simply pass the invocation onto the
                           internal reference.<br><br>

                           Consider for example:
<code><pre>
   String toString() {
      // no arguments, object return ...
      return (String)invokeRef.invoke("toString", null);
   }
   boolean equals(Object o) {
      // single argument, primitive return...
      return ((Boolean)invokeRef.invoke("equals", o)).booleanValue());
   }
   void someMethod(String a, String b, String c) {
      // multiple arguments, no return...
      invokeRef.invoke("someMethod", new Object{} { a, b, c });
   }
</pre></code>
                           Ultimately that's all there is to an item. To make an item remotely
                           accessible, it is passed to the
                           <a href=docs/gnu/cajo/utils/ItemServer>ItemServer</a> static
                           method
                           <a href=docs/gnu/cajo/utils/ItemServer.html#bind(java.lang.Object,%20java.lang.String,%20boolean,%20gnu.cajo.utils.Multicast)>bind</a>.
                           A single virtual machine can remote as many items as it wants. An application
                           can obtain a reference to a remote item using the ItemServer static method
                           <a href=docs/gnu/cajo/invoke/Remote.html#getItem(java.lang.String)>getItem</a>;
                           requesting the item by name.  It can also  listen for remote item broadcasts,
                           using the <a href=multicast.html>Multicast</a> class.<br><br>

                           As a <i>de facto</i> convention; the primary item served by a VM is typically
                           bound under the name <i>"main"</i>. By handling items using their Invoke
                           interface, an item need not know, or even care, if its called items are
                           local or remote. If it should be important to know, either the remoteness or
                           locality of an item, this can be easily tested in the following way:
<pre><code>
   if (foo instanceof RemoteInvoke) {
      // the reference is to a remote item ...
   } else {
      // the reference is to a local item ...
   }
</code></pre>
                           This is the sole purpose of the
                           <a href=docs/gnu/cajo/invoke/RemoteInvoke.html>RemoteInvoke</a> interface;
                           testing locality, as it is otherwise a bodyless interface.<br><br>

                           A BaseItem can also optionally define a
                           <a href= docs/gnu/cajo/utils/BaseItem.MainThread.html>MainThread</a> object,
                           which would be started automatically by the ItemServer, on binding the
                           item. This allows an item to perform default processing independently of
                           other invocation threads. Its main thread can be referenced via its public
                           member, named <a href=docs/gnu/cajo/utils/BaseItem.html#thread>thread</a>,
                           on which it can be interrupted, and on which the item's run method should
                           periodically monitor, to check if the thread <code>isInterrupted</code>, and
                           perform an orderly shutdown. An item can also have no main thread; this
                           would be called an <i>event driven</i> item, meaning it executes only when
                           called by a client.<br><br>

                           In the next section, see how an item can use a <a href=proxy.html>proxy</a>
                           to send some, or a majority, of its functionality, and even an optional user
                           interface, to the client.<br><br>
                           
                           <div align="center">
                              <font face="Verdana, Helvetica" size="-2">
                                 <hr width="80%">
                                 Items are just objects, which can be also invoked by other (remote) objects.
                              </font>
                           </div>
<!-- end main.html -->
                        </font>
                     </td>
                  </tr>
               </table>
            </td>
         </tr>
      </table>
   </body>
</html>
