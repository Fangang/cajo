<!-- ANT BUILD FILE (Ref. http://jakarta.apache.org/ant ) -->
<project name="cajo" default="library" basedir=".">
    <description>
        Simple powerful distributed computing.
    </description>
    <target name="library">
        <!-- the standard library deployment package -->  
        <javac srcdir="." target="1.2" source="1.2" includes="gnu/cajo/invoke/*.java"/> 
        <javac srcdir="." target="1.2" source="1.2" includes="gnu/cajo/utils/*.java"/> 
        <javac srcdir="." target="1.2" source="1.2" includes="gnu/cajo/utils/extra/*.java"/> 
        <javac srcdir="." target="1.2" source="1.2" includes="gnu/cajo/*.java"/> 
        <rmic stubversion="vcompat" classname="gnu.cajo.invoke.Remote" base="."/>
        <delete>
            <fileset dir="." includes="
                gnu/cajo/utils/ProxyLoader.class
                gnu/cajo/utils/BaseProxy*.class
            "/>
            <!-- ProxyLoader and BaseProxy must be dynamically loaded -->  
        </delete>
        <jar basedir="."
            jarfile="cajo.jar"
            manifest="cajo.mft"
            includes="
                readme.txt
                gnu/cajo/*.class
                gnu/cajo/invoke/*.class
                gnu/cajo/utils/*.class
                gnu/cajo/utils/extra/*.class
            "/>
        <delete>
            <fileset dir="." includes="
                gnu/cajo/*.class
                gnu/cajo/invoke/*.class
                gnu/cajo/utils/*.class
                gnu/cajo/utils/extra/*.class
            "/>
        </delete>
    </target>
    <target name="grail">
        <!-- the grail library deployment package -->  
        <javac srcdir="." target="1.2" source="1.2" includes="gnu/cajo/Cajo.java"/> 
        <rmic stubversion="vcompat" classname="gnu.cajo.invoke.Remote" base="."/>
        <javac srcdir="." target="1.2" source="1.2" includes="gnu/cajo/utils/CodebaseServer.java"/> 
        <delete>
            <fileset dir="." includes="
                gnu/cajo/utils/ItemServer$JarClassLoader.class
            "/>
            <!-- Not needed in grail.jar proper -->  
        </delete>
        <jar basedir="."
            jarfile="grail.jar"
            manifest="cajo.mft"
            includes="
                readme.txt
                gnu/cajo/*.class
                gnu/cajo/invoke/*.class
                gnu/cajo/utils/*.class
                gnu/cajo/utils/extra/*.class
            "/>
        <delete>
            <fileset dir="." includes="
                gnu/cajo/*.class
                gnu/cajo/invoke/*.class
                gnu/cajo/utils/*.class
                gnu/cajo/utils/extra/*.class
            "/>
        </delete>
    </target>
    <target name="client">
        <javac srcdir="." target="1.2" source="1.2" includes="gnu/cajo/invoke/Client.java"/> 
        <javac srcdir="." target="1.2" source="1.2" includes="gnu/cajo/invoke/JClient.java"/> 
        <rmic stubversion="vcompat" classname="gnu.cajo.invoke.Remote" base="."/>
        <jar basedir="."
             jarfile="client.jar"
             manifest="client.mft"
             includes="
                 gnu/cajo/invoke/*.class
             "/>
        <delete>
            <fileset dir="." includes="
                 gnu/cajo/invoke/*.class
             "/>
         </delete>
    </target>
    <target name="proxy">
        <javac srcdir="." target="1.2" source="1.2" includes="example/Builder.java"/> 
        <javac srcdir="." target="1.2" source="1.2" includes="gnu/cajo/utils/ProxyLoader.java"/> 
        <java classpath="." classname="example.Builder" fork="true"/> 
        <jar basedir="."
             jarfile="proxy.jar"
             includes="
                 example/*.class
                 example/include/*.*
                 example/gui/*.class
                 gnu/cajo/utils/BaseProxy*.class
                 gnu/cajo/utils/ProxyLoader.class
             "/>
        <delete>
            <fileset dir="." includes="
                 example/*.class
                 example/gui/*.class
                 example/include/proxy.ser
                 gnu/cajo/invoke/*.class
                 gnu/cajo/utils/*.class
             "/>
        </delete>
    </target>
    <target name="server" depends="client, proxy">
        <javac srcdir="." target="1.2" source="1.2" includes="example/Main.java"/> 
        <rmic stubversion="vcompat" classname="gnu.cajo.invoke.Remote" base="."/>
    </target>
    <target name="make1" depends="client, proxy, server">
        <jar basedir="."
             jarfile="server.jar"
             manifest="example/example.mft"
             includes="
                 example/*.class
                 gnu/cajo/invoke/*.class
                 gnu/cajo/utils/*.class
                 proxy.jar
                 client.jar
             "/>
        <delete>
            <fileset dir="." includes="
                 example/*.class
                 gnu/cajo/invoke/*.class
                 gnu/cajo/utils/*.class
                 proxy.jar
                 client.jar
             "/>
        </delete>
    </target>
    <target name="make2" depends="client, proxy, server">
        <jar basedir="."
             jarfile="server.jar"
             manifest="example/example.mft"
             includes="
                 example/*.class
                 gnu/cajo/invoke/*.class
                 gnu/cajo/utils/*.class
                 proxy.jar
             "/>
        <delete>
            <fileset dir="." includes="
                 example/*.class
                 gnu/cajo/invoke/*.class
                 gnu/cajo/utils/*.class
                 proxy.jar
             "/>
        </delete>
    </target>
    <target name="make3" depends="client, proxy, server">
        <jar basedir="."
             jarfile="server.jar"
             manifest="example/example.mft"
             includes="
                 example/*.class
                 gnu/cajo/invoke/*.class
                 gnu/cajo/utils/*.class
             "/>
        <delete>
            <fileset dir="." includes="
                 example/*.class
                 gnu/cajo/invoke/*.class
                 gnu/cajo/utils/*.class
             "/>
        </delete>
    </target>
    <target name="make4" depends="client, proxy, library">
        <javac srcdir="." target="1.2" source="1.2" includes="example/Main.java"/> 
        <jar basedir="."
             jarfile="server.jar"
             manifest="example/example.mft"
             includes="
                 example/*.class
                 gnu/cajo/utils/ProxyLoader.class
             "/>
        <delete>
            <fileset dir="." includes="
                 example/*.class
                 gnu/cajo/invoke/*.class
                 gnu/cajo/utils/*.class
             "/>
        </delete>
    </target>
    <target name="doc">
       <mkdir dir="docs" />
       <javadoc destdir="docs" author="true"
           windowtitle="The cajo project"
           overview="gnu/cajo/overview.html" >
           <fileset dir="gnu/cajo" />
       </javadoc>
    </target>
</project>
